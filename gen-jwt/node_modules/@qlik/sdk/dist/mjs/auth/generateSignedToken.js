import jsonwebtoken from "jsonwebtoken";
import {
  generateRandomString,
  validateClaims,
  validateSigningOptions
} from "../utils/utils.js";
function generateSignedToken({
  jti = generateRandomString(8),
  sub,
  subType,
  name,
  email,
  email_verified = true,
  groups = [],
  expiresIn,
  notBefore,
  keyid,
  issuer,
  algorithm = "RS256",
  audience = "qlik.api/login/jwt-session"
}, crt) {
  const claims = {
    jti,
    sub,
    subType,
    name,
    email,
    email_verified,
    groups
  };
  validateClaims(claims);
  const signingOptions = {
    expiresIn,
    notBefore,
    keyid,
    issuer,
    algorithm,
    audience
  };
  validateSigningOptions(signingOptions);
  return jsonwebtoken.sign(claims, crt, signingOptions);
}
export {
  generateSignedToken as default
};
